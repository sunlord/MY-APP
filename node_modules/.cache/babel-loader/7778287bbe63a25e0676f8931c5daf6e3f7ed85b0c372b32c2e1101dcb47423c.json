{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as util from './core/util';\nimport env from './core/env';\nimport timsort from './core/timsort';\nimport { REDARAW_BIT } from './graphic/constants';\nvar invalidZErrorLogged = false;\nfunction logInvalidZError() {\n  if (invalidZErrorLogged) {\n    return;\n  }\n  invalidZErrorLogged = true;\n  console.warn('z / z2 / zlevel of displayable is invalid, which may cause unexpected errors');\n}\nfunction shapeCompareFunc(a, b) {\n  if (a.zlevel === b.zlevel) {\n    if (a.z === b.z) {\n      return a.z2 - b.z2;\n    }\n    return a.z - b.z;\n  }\n  return a.zlevel - b.zlevel;\n}\nvar Storage = function () {\n  function Storage() {\n    this._roots = [];\n    this._displayList = [];\n    this._displayListLen = 0;\n    this.displayableSortFunc = shapeCompareFunc;\n  }\n  Storage.prototype.traverse = function (cb, context) {\n    for (var i = 0; i < this._roots.length; i++) {\n      this._roots[i].traverse(cb, context);\n    }\n  };\n  Storage.prototype.getDisplayList = function (update, includeIgnore) {\n    includeIgnore = includeIgnore || false;\n    var displayList = this._displayList;\n    if (update || !displayList.length) {\n      this.updateDisplayList(includeIgnore);\n    }\n    return displayList;\n  };\n  Storage.prototype.updateDisplayList = function (includeIgnore) {\n    this._displayListLen = 0;\n    var roots = this._roots;\n    var displayList = this._displayList;\n    for (var i = 0, len = roots.length; i < len; i++) {\n      this._updateAndAddDisplayable(roots[i], null, includeIgnore);\n    }\n    displayList.length = this._displayListLen;\n    env.canvasSupported && timsort(displayList, shapeCompareFunc);\n  };\n  Storage.prototype._updateAndAddDisplayable = function (el, clipPaths, includeIgnore) {\n    if (el.ignore && !includeIgnore) {\n      return;\n    }\n    el.beforeUpdate();\n    el.update();\n    el.afterUpdate();\n    var userSetClipPath = el.getClipPath();\n    if (el.ignoreClip) {\n      clipPaths = null;\n    } else if (userSetClipPath) {\n      if (clipPaths) {\n        clipPaths = clipPaths.slice();\n      } else {\n        clipPaths = [];\n      }\n      var currentClipPath = userSetClipPath;\n      var parentClipPath = el;\n      while (currentClipPath) {\n        currentClipPath.parent = parentClipPath;\n        currentClipPath.updateTransform();\n        clipPaths.push(currentClipPath);\n        parentClipPath = currentClipPath;\n        currentClipPath = currentClipPath.getClipPath();\n      }\n    }\n    if (el.childrenRef) {\n      var children = el.childrenRef();\n      for (var i = 0; i < children.length; i++) {\n        var child = children[i];\n        if (el.__dirty) {\n          child.__dirty |= REDARAW_BIT;\n        }\n        this._updateAndAddDisplayable(child, clipPaths, includeIgnore);\n      }\n      el.__dirty = 0;\n    } else {\n      var disp = el;\n      if (clipPaths && clipPaths.length) {\n        disp.__clipPaths = clipPaths;\n      } else if (disp.__clipPaths && disp.__clipPaths.length > 0) {\n        disp.__clipPaths = [];\n      }\n      if (isNaN(disp.z)) {\n        logInvalidZError();\n        disp.z = 0;\n      }\n      if (isNaN(disp.z2)) {\n        logInvalidZError();\n        disp.z2 = 0;\n      }\n      if (isNaN(disp.zlevel)) {\n        logInvalidZError();\n        disp.zlevel = 0;\n      }\n      this._displayList[this._displayListLen++] = disp;\n    }\n    var decalEl = el.getDecalElement && el.getDecalElement();\n    if (decalEl) {\n      this._updateAndAddDisplayable(decalEl, clipPaths, includeIgnore);\n    }\n    var textGuide = el.getTextGuideLine();\n    if (textGuide) {\n      this._updateAndAddDisplayable(textGuide, clipPaths, includeIgnore);\n    }\n    var textEl = el.getTextContent();\n    if (textEl) {\n      this._updateAndAddDisplayable(textEl, clipPaths, includeIgnore);\n    }\n  };\n  Storage.prototype.addRoot = function (el) {\n    if (el.__zr && el.__zr.storage === this) {\n      return;\n    }\n    this._roots.push(el);\n  };\n  Storage.prototype.delRoot = function (el) {\n    if (el instanceof Array) {\n      for (var i = 0, l = el.length; i < l; i++) {\n        this.delRoot(el[i]);\n      }\n      return;\n    }\n    var idx = util.indexOf(this._roots, el);\n    if (idx >= 0) {\n      this._roots.splice(idx, 1);\n    }\n  };\n  Storage.prototype.delAllRoots = function () {\n    this._roots = [];\n    this._displayList = [];\n    this._displayListLen = 0;\n    return;\n  };\n  Storage.prototype.getRoots = function () {\n    return this._roots;\n  };\n  Storage.prototype.dispose = function () {\n    this._displayList = null;\n    this._roots = null;\n  };\n  return Storage;\n}();\nexport default Storage;","map":{"version":3,"names":["util","env","timsort","REDARAW_BIT","invalidZErrorLogged","logInvalidZError","console","warn","shapeCompareFunc","a","b","zlevel","z","z2","Storage","_roots","_displayList","_displayListLen","displayableSortFunc","prototype","traverse","cb","context","i","length","getDisplayList","update","includeIgnore","displayList","updateDisplayList","roots","len","_updateAndAddDisplayable","canvasSupported","el","clipPaths","ignore","beforeUpdate","afterUpdate","userSetClipPath","getClipPath","ignoreClip","slice","currentClipPath","parentClipPath","parent","updateTransform","push","childrenRef","children","child","__dirty","disp","__clipPaths","isNaN","decalEl","getDecalElement","textGuide","getTextGuideLine","textEl","getTextContent","addRoot","__zr","storage","delRoot","Array","l","idx","indexOf","splice","delAllRoots","getRoots","dispose"],"sources":["/Users/jiong/Downloads/my-app/node_modules/zrender/lib/Storage.js"],"sourcesContent":["import * as util from './core/util';\nimport env from './core/env';\nimport timsort from './core/timsort';\nimport { REDARAW_BIT } from './graphic/constants';\nvar invalidZErrorLogged = false;\nfunction logInvalidZError() {\n    if (invalidZErrorLogged) {\n        return;\n    }\n    invalidZErrorLogged = true;\n    console.warn('z / z2 / zlevel of displayable is invalid, which may cause unexpected errors');\n}\nfunction shapeCompareFunc(a, b) {\n    if (a.zlevel === b.zlevel) {\n        if (a.z === b.z) {\n            return a.z2 - b.z2;\n        }\n        return a.z - b.z;\n    }\n    return a.zlevel - b.zlevel;\n}\nvar Storage = (function () {\n    function Storage() {\n        this._roots = [];\n        this._displayList = [];\n        this._displayListLen = 0;\n        this.displayableSortFunc = shapeCompareFunc;\n    }\n    Storage.prototype.traverse = function (cb, context) {\n        for (var i = 0; i < this._roots.length; i++) {\n            this._roots[i].traverse(cb, context);\n        }\n    };\n    Storage.prototype.getDisplayList = function (update, includeIgnore) {\n        includeIgnore = includeIgnore || false;\n        var displayList = this._displayList;\n        if (update || !displayList.length) {\n            this.updateDisplayList(includeIgnore);\n        }\n        return displayList;\n    };\n    Storage.prototype.updateDisplayList = function (includeIgnore) {\n        this._displayListLen = 0;\n        var roots = this._roots;\n        var displayList = this._displayList;\n        for (var i = 0, len = roots.length; i < len; i++) {\n            this._updateAndAddDisplayable(roots[i], null, includeIgnore);\n        }\n        displayList.length = this._displayListLen;\n        env.canvasSupported && timsort(displayList, shapeCompareFunc);\n    };\n    Storage.prototype._updateAndAddDisplayable = function (el, clipPaths, includeIgnore) {\n        if (el.ignore && !includeIgnore) {\n            return;\n        }\n        el.beforeUpdate();\n        el.update();\n        el.afterUpdate();\n        var userSetClipPath = el.getClipPath();\n        if (el.ignoreClip) {\n            clipPaths = null;\n        }\n        else if (userSetClipPath) {\n            if (clipPaths) {\n                clipPaths = clipPaths.slice();\n            }\n            else {\n                clipPaths = [];\n            }\n            var currentClipPath = userSetClipPath;\n            var parentClipPath = el;\n            while (currentClipPath) {\n                currentClipPath.parent = parentClipPath;\n                currentClipPath.updateTransform();\n                clipPaths.push(currentClipPath);\n                parentClipPath = currentClipPath;\n                currentClipPath = currentClipPath.getClipPath();\n            }\n        }\n        if (el.childrenRef) {\n            var children = el.childrenRef();\n            for (var i = 0; i < children.length; i++) {\n                var child = children[i];\n                if (el.__dirty) {\n                    child.__dirty |= REDARAW_BIT;\n                }\n                this._updateAndAddDisplayable(child, clipPaths, includeIgnore);\n            }\n            el.__dirty = 0;\n        }\n        else {\n            var disp = el;\n            if (clipPaths && clipPaths.length) {\n                disp.__clipPaths = clipPaths;\n            }\n            else if (disp.__clipPaths && disp.__clipPaths.length > 0) {\n                disp.__clipPaths = [];\n            }\n            if (isNaN(disp.z)) {\n                logInvalidZError();\n                disp.z = 0;\n            }\n            if (isNaN(disp.z2)) {\n                logInvalidZError();\n                disp.z2 = 0;\n            }\n            if (isNaN(disp.zlevel)) {\n                logInvalidZError();\n                disp.zlevel = 0;\n            }\n            this._displayList[this._displayListLen++] = disp;\n        }\n        var decalEl = el.getDecalElement && el.getDecalElement();\n        if (decalEl) {\n            this._updateAndAddDisplayable(decalEl, clipPaths, includeIgnore);\n        }\n        var textGuide = el.getTextGuideLine();\n        if (textGuide) {\n            this._updateAndAddDisplayable(textGuide, clipPaths, includeIgnore);\n        }\n        var textEl = el.getTextContent();\n        if (textEl) {\n            this._updateAndAddDisplayable(textEl, clipPaths, includeIgnore);\n        }\n    };\n    Storage.prototype.addRoot = function (el) {\n        if (el.__zr && el.__zr.storage === this) {\n            return;\n        }\n        this._roots.push(el);\n    };\n    Storage.prototype.delRoot = function (el) {\n        if (el instanceof Array) {\n            for (var i = 0, l = el.length; i < l; i++) {\n                this.delRoot(el[i]);\n            }\n            return;\n        }\n        var idx = util.indexOf(this._roots, el);\n        if (idx >= 0) {\n            this._roots.splice(idx, 1);\n        }\n    };\n    Storage.prototype.delAllRoots = function () {\n        this._roots = [];\n        this._displayList = [];\n        this._displayListLen = 0;\n        return;\n    };\n    Storage.prototype.getRoots = function () {\n        return this._roots;\n    };\n    Storage.prototype.dispose = function () {\n        this._displayList = null;\n        this._roots = null;\n    };\n    return Storage;\n}());\nexport default Storage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}